### 규칙

### 추천규칙.

#### 사람 - 영양소 측면.

1. (주영님이 만든 것으로부터) 사람의 데이터를 받아옴.

    - 몸무게, 나이 성별을 이용해서 일일 섭취 권장량 데이터 계산 및 저장(carbon, protein, fat)

2. list 형식으로 차례대로 [[정량 3개], [상한 3개], [하한 3개]] 를 만듦.(탄단지, 권장량 3개를 제외한 나머지는 초깃값으로 0)

    - 탄단지 우선순위는 탄>=단>=지, 데이터를 비교해서, 부족하다의 기준은 하루 섭취량의 90% 미만, 과하다의 기준은 110% 초과(110%를 추가했을 때는 list 변동 x).
    - ex. 하루 100g의 탄수화물을 섭취해야 한다고 가정했을 때 95g이면 잘 먹었다고 가정.
    - ex2. 위와 같은 가정에서 85g이면 부족하다고 판단, 음식 추천기준에 들어감.

3. 데이터를 받아서 위의 기준으로 계산함으로써 4행 3열의 기준을 얻을 수 있음.(set nutrient_table)

|  \   |        탄수화물         |   단백질   |    지방    |
| :--: | :---------------------: | :--------: | :--------: |
| 상한 |  최대 채워도 되는 기준  | 2.2과 동일 | 2.2과 동일 |
| 정량 |    100%를 채우는 양     | 3.2와 동일 | 3.2와 동일 |
| 하한 | 최소 채우는게 좋은 기준 | 4.2와 동일 | 4.2와 동일 |
| 중량 |       정량의 절반       | 5.2와 동일 | 5.2와 동일 |

-   중량은 마지막 기준을 위해 만들어놓은 임시기준.
-   (이것은 bar 그래프로 보는 것이 더 효과적이나 md에서 지원되는 기능은 아니기에 생략.)

#### 음식 측면.

-   하한까지 모두 0일 경우 물 추천..(이미 하루치 음식을 다 먹은 케이스.)

1. 3으로부터 영양소를 맞추기 위한 블록쌓기.

    - 음식을 찾는 기준은

        1. 모든 기준으로 하한 - 정량에 맞춤.
        2. 모든 기준으로 하한 - 상한에 맞춤.
        3. 1,2가 없을 시 run의 다음으로 넘어감.

    - 만약 리스트에 여러개의 음식이 들어가있다면
        - random pick.

2. run.

    1. 1개의 음식으로 기준에 맞춰지게 찾아진다면?
        - 그대로 추천, 기준에 맞는 음식이 여러개라면 random 3개를 골라 send(2에서 넘어온 것이라면 1개.)
    2. 만약 1개의 음식으로 기준이 맞춰지질 않는다면?
        - 모든 상한 이하의 음식중 random pick, 그 후 1의 과정으로 돌아감.
    3. 음식이 5개가 넘어가질 않길 + 같은 음식이 들어가있지 않길..? (인디언 기우제??)

3. 음식의 추천은 5개를 넘어가지 않는 것으로..?(미정)
    - 추후 고려시 음식의 종류를 나눌 필요는 있음.  
      (일례로 대부분의 음식은 반찬이 필수는 아니지만 우리나라의 경우 한식에 반찬이 업다고 생각해보면..)

#### output(WANTED)

추천리스트에 있는 음식은 총 3 bundle. 1개로 끝나는 음식이 3개 이상이면 좋겠지만, 그게 아니라면 5종류 이하 묶음이 한 bundle로 구성되어 들어가게 함.

### 알고리즘.. how?... js만 사용한다고 가정...

(ipynb랑 연동시키면 좋을까?.. 만약 좋다면 어떻게 좋은지 모르겠다.)

1. js로 데이터를 mongodb에서 기준에 맞는 음식데이터를 뽑아옴, 만약 run1에서 clear시 send.(js에서 쿼리를 이용해서 데이터 뽑는 방법 연습!)
2. run2로 넘어갈 시
    - temp=[]를 만든 후 temp에 랜덤으로 select된 음식을 넣음.
    - nutrient_table에서 temp의 마지막에 들어간 음식의 영양소를 각각 뺌.
    - 영양소가 모두 적정량에 들어갔을 시 temp send.

##### 고려되야 할 것은?(할까?)

-   이미 먹은 음식은 추천리스트에서 제외..
-   temp를 만들게 될 경우 동일한 음식도 제외..  
    (위 두 가지 케이스는 종류로 나눠서 제외해야할 지는 모르겠음.)

#### 현재의 한계

1.  오로지 탄단지만을 기준으로 삼음

    -   다른 영양학적 밸런스 & 맛에 대한 밸런스 역시 무시.

2.  못 먹는 재료(ex. from 알레르기)에 대한 고려가 되질 않음.
3.  혐오식품?(ex.수스트뢰밍 or 푹 삭힌 홍어)에 대한 추천이 될 가능성...
